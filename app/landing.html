{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" href="/js/packages/vegas/vegas.min.css">
{% endblock %}

{% block content %}
<div class="landing">
    <div class="landing-header hide_in_pc">
        {% include "parts/header.html" %}
    </div>

    <a href="">
        <img class="landing-logo" src="/images/logo.png" alt="">
    </a>

    <div class="landing-title-wrap">
        <div class="landing-title">
            <div class="hide_in_mobile">
                <img src="/images/landing/title.png" alt="">
            </div>
            <a href="/home.html">
                <div class="landing-title-enter">
                    <div class="landing-title-enter-btn">点击进入</div>
                    <div class="landing-title-enter-circle hide_in_pc"></div>
                </div>
            </a>
        </div>
    </div>

    <div class="landing-swiper"></div>
    <div class="landing-pixi">
        <div id="water"></div>
        <div id="cloud"></div>
        <div id="sakura"></div>
        <!-- <div id="nianlun"></div> -->
        <!-- <div id="guang"></div> -->
    </div>
    <div class="landing-swiper-pagination hide_in_mobile"></div>

    <div id="firework1" class="landing-fireworks"></div>
    <div id="firework2" class="landing-fireworks"></div>

</div>

{% endblock %}

{% block script %}
<script src="/js/packages/fireworks/fireworks.min.js"></script>
<script src="/js/packages/vegas/vegas.min.js"></script>
<script src="/js/packages/pixi/pixi.min.js"></script>
<!-- <script src="/js/packages/landing/water.js"></script> -->
<script src="/js/packages/landing/main.js"></script>
<script>
    var isMobile = screen.width <= 750;
    var slides = [
        {src: isMobile ? "/images/landing/page1_mobile.jpg" : "/images/landing/page1.jpg", animation: "fade", transition: "fade"},
        {src: "/images/landing/page2.jpg"},
        {src: "/images/landing/page3.jpg"},
        {src: isMobile ? "/images/landing/page4_mobile.jpg" : "/images/landing/page4.jpg"}
    ]

    $(".landing-swiper").vegas({
        slides: slides,
        timer: false,
        delay: 5000,
        shuffle: false,
        transition: isMobile?"slideDown2" :"fade",
        // animation: isMobile?[]:['kenburnsDown', 'kenburnsLeft', 'kenburnsRight'],
        init: function (options) {
            if(!isMobile){
                $.each(options.slides, function (index) {
                    let dom = '<div class="landing-swiper-pagination-item" data-index="' + index + '"></div>'
                    if(index===0) {
                        dom = '<div class="landing-swiper-pagination-item landing-swiper-pagination-active" data-index="' + index + '"></div>'
                    }
                    $(".landing-swiper-pagination").append(dom)

                })
                $('.landing-swiper-pagination').on('click','.landing-swiper-pagination-item', function () {
                    $(".landing-swiper").vegas('jump', parseInt($(this).attr("data-index")));
                })
            }
        },
        walk: function (index) {
            if(!isMobile){
                $(".landing-swiper-pagination > .landing-swiper-pagination-item").each(function (i) {
                    if(i===index) {
                        $(this).addClass("landing-swiper-pagination-active")
                    } else {
                        $(this).removeClass("landing-swiper-pagination-active")
                    }
                })
            }
            if (index === 0) {
                firework1.start()
                if(!isMobile){
                    firework2.start()
                }
                $(".landing-title img").css("opacity", "0");
            } else {
                firework1.stop()
                if(!isMobile){
                    firework2.stop()
                }
                $(".landing-title img").css("opacity", "1");
            }
            $(".landing-pixi").children().each(function() {
                $(this).fadeOut()
            })
            if(index===1) {
                $("#water").fadeIn()
            }
            if(index===2){
                $("#sakura").fadeIn()
            }
        }
    });

    var fireworkConfig1 = {
        "hue": {
            "min": 50,
            "max": 350
        },
        "delay": {
            "min": 20,
            "max": 40
        },
        "rocketsPoint": {
            "min": 21,
            "max": 45
        },
        "opacity": 0.1,
        "acceleration": 1.1,
        "friction": 0.94,
        "gravity": 0.3,
        "particles": 130,
        "trace": 1,
        "traceSpeed": 100,
        "explosion": 7,
        "intensity": 17,
        "flickering": 28,
        "lineStyle": "round",
        "lineWidth": {
            "explosion": {
                "min": 2,
                "max": 5.5
            },
            "trace": {
                "min": 0.00000001,
                "max": 0.00000001
            }
        },
        "autoresize": true,
        "brightness": {
            "min": 50,
            "max": 100,
            "decay": {
                "min": 0.012,
                "max": 0.024
            }
        },
        "boundaries": {
            "visible": false,
            "x": 0,
            "y": 0,
            "width": isMobile ? screen.width : screen.width / 3,
            "height": screen.height
        }
    }

    var firework1 = new Fireworks(document.querySelector('#firework1'), fireworkConfig1)
    // firework1.start()
    if (!isMobile) {
        var fireworkConfig2 = {
            "hue": {
                "min": 50,
                "max": 350
            },
            "delay": {
                "min": 20,
                "max": 40
            },
            "rocketsPoint": {
                "min": 21,
                "max": 45
            },
            "opacity": 0.1,
            "acceleration": 1.1,
            "friction": 0.94,
            "gravity": 0.3,
            "particles": 130,
            "trace": 1,
            "traceSpeed": 100,
            "explosion": 7,
            "intensity": 17,
            "flickering": 28,
            "lineStyle": "round",
            "lineWidth": {
                "explosion": {
                    "min": 2,
                    "max": 5.5
                },
                "trace": {
                    "min": 0.00000001,
                    "max": 0.00000001
                }
            },
            "autoresize": true,
            "brightness": {
                "min": 50,
                "max": 100,
                "decay": {
                    "min": 0.012,
                    "max": 0.024
                }
            },
            "boundaries": {
                "visible": false,
                "x": screen.width / 1.4,
                "y": 50,
                "width": screen.width * 2.2,
                "height": screen.height
            }
        }
        var firework2 = new Fireworks(document.querySelector('#firework2'), fireworkConfig2)
        // firework2.start()
    }
</script>
{% endblock %}